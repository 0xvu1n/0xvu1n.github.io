---
title: Exploiting known vulnerabilities of WordPress
description: Finding & exploiting known vulnerabilities in WordPress websites, Finding the targets & enumerating sub-domains.
date: 2024-09-21
last_modified_at: 2024-09-21
author: vu1n
layout: post
categories: [Vulnerabilities]
tags: [CVE, Injection, Vulnerability, WordPress]
---

Thanks for visiting, From last few weeks I'm focusing more on finding vulnerabilities in WordPress websites and tools that revolve around WordPress testing. During the process I've read many blogs & found some good resources from some top researchers.  

As we all know WordPress is a free and open-source content management system written in PHP and paired with a MySQL or MariaDB database.
Features include a plugin architecture and a template system. WordPress holds 78% market share (3899000 websites) which is highest among all the CMSs.  

![Statistics](https://github.com/0xvu1n/0xvu1n.github.io/blob/b38d643610b6deaa0ba236a745fdbf20f0745d75/assets/CMS%20market%20share.png)  

You can go through the official documentation of the [WordPress](https://wordpress.org/documentation/) to understand the structure of it 
or from a security point of view you can visit this blog [Patchstack academy](https://patchstack.com/academy/wordpress/getting-started/) 
to understand detailed WordPress ecosystem including plugins & themes, the vulnerabilities are explained really well here.  

Another good resource to understand WordPress vulnerabilities is to refer [wpscan.com](https://wpscan.com) which is the official database of WordPress vulnerabilities. WPScan is also a black‑box vulnerability scanner shipped as a ruby gem. It comes preinstalled in some Linux distributions like Kali, BlackArch, Pentoo. So With right toolbase & recon techniques we can find enough vulnerable WordPress websites. Some of the tools/resources that I used to perform these operations are ...  

- [Projectdiscovery tools](https://projectdiscovery.io/open-source) - A suite of open source tools  
- [WPScan](https://wpscan.com/how-to-install-wpscan/) - WordPress security scanner  
- [WPwatcher](https://wpwatcher.readthedocs.io/en/latest/) - Wrapper for WPscan that allows scheduled scan  
- [Publicwww](https://publicwww.com/) - Search engine for source code  
- [Shodan](https://shodan.io/) or [fofa](https://en.fofa.info/) - Seach engine for everything  
- [crt.sh](https://crt.sh/) - Certificate search  
- [WPIntel](https://chromewebstore.google.com/detail/wpintel-wordpress-vulnera/mkhmkjcbidkifopffebieonhhkondlfe?hl=en) - Browser extension  

Here for example, We'll try to find the website running the WordPress plugin **wp-jobsearch < 2.3.4** which is vulnerable
to Authentication Bypass and have a CVE-2023-6584. So there are two different approach you can try, first if you're having a running 
WordPress website you can run WPscan with API token against the website (Make sure you're authorized to do so.) and second you can try google
search operators to find the targets running WordPress. Below is the demo vulnerability report of a single website.  

```

sudo wpscan --api-token WuXM*** --url https://wordpress.com --force --random-user-agent --disable-tls-checks -f cli -o wp-pci-report.txt

_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.25
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: https://jobs.*.co.in/ [141.*.*.182]
[+] Started: Sat Sep 21 10:57:12 2024

Interesting Finding(s):

[+] Headers
 | Interesting Entry: Server: Apache/2.4.41 (Ubuntu)
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: https://jobs.*.co.in/robots.txt
 | Interesting Entries:
 |  - /wp-content/uploads/wc-logs/
 |  - /wp-content/uploads/woocommerce_transient_files/
 |  - /wp-content/uploads/woocommerce_uploads/
 |  - /wp-admin/
 |  - /wp-admin/admin-ajax.php
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: https://jobs.*.co.in/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] wp-jobsearch
 | Location: https://jobs.*.co.in/wp-content/plugins/wp-jobsearch/
 | Last Updated: 2024-09-21T00:10:54.000Z
 | [!] The version is out of date, the latest version is 2.6.2
 |
 | Found By: Urls In Homepage (Passive Detection)
 | Confirmed By: Urls In 404 Page (Passive Detection)
 |
 | [!] 7 vulnerabilities identified:
 |
 | [!] Title: JobSearch WP Job Board < 2.3.4 - Arbitrary File Upload to RCE
 |     Fixed in: 2.3.4
 |     References:
 |      - https://wpscan.com/vulnerability/757412f4-e4f8-4007-8e3b-639a72b33180
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6585
 |
 | [!] Title: JobSearch WP Job Board < 2.3.4 - Authentication Bypass
 |     Fixed in: 2.3.4
 |     References:
 |      - https://wpscan.com/vulnerability/e528e3cd-a45c-4bf7-a37a-101f5c257acd
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2023-6584
 |
 | [!] Title: JobSearch <= 2.3.4 - Authentication Bypass to Account Takeover
 |     References:
 |      - https://wpscan.com/vulnerability/16899f0d-5a0f-46cd-97f6-c778d643faac
 |      - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2024-43245
 |      - https://patchstack.com/database/vulnerability/wp-jobsearch/wordpress-jobsearch-plugin-2-3-4-unauthenticated-account-takeover-vulnerability
 |

[i] No Config Backups Found.

[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 11
 | Requests Remaining: 3

[+] Finished: Sat Sep 21 11:00:32 2024
[+] Requests Done: 1490
[+] Cached Requests: 9
[+] Data Sent: 486.062 KB
[+] Data Received: 31.157 MB
[+] Memory used: 265.246 MB
[+] Elapsed time: 00:03:20

```

So here the Website is vulnerable to authenticated/unauthenticated vulnerabilities & if we look at the result there is one finding
we can see with the title **JobSearch WP Job Board < 2.3.4 - Authentication Bypass** having CVE-2023-6584.  
This is the [exploit](https://wpscan.com/vulnerability/e528e3cd-a45c-4bf7-a37a-101f5c257acd/) code that needs to be run on the browser console

![Exploit code](https://github.com/0xvu1n/0xvu1n.github.io/blob/ddbaf0e78e366b93991bda641eff018205ed5eb9/assets/exploit.png)  

It allows attacker to log-in as any users with the only knowledge of that user's email address. Complexity of the attack is low and does not require technical experties. So to find the legitimate 
email of the admin we can enumerate the login panel or we can use 
[WPIntel](https://chromewebstore.google.com/detail/wpintel-wordpress-vulnera/mkhmkjcbidkifopffebieonhhkondlfe?hl=en) browser extension.
Please refer the video poc of the same.

https://github.com/user-attachments/assets/3aa75b94-94ce-4dce-9e57-e019036791ea

Another method is we can use source code search engines to find the vulnerable WordPress websites. So here I suggest to keep watch on
the new nuclei templates for WordPress submitted by the community. Lets explore one of the template **CVE-2023-3495 (Wordpress Country State City Dropdown <=2.7.2 - SQL Injection)** 
having critical severity with the score of 9.8. This template detects Country State City Dropdown CF7 plugin for WordPress which is vulnerable to SQL Injection via the ‘cnt’
and 'sid' parameters in versions up to, and including, 2.7.2 due to insufficient escaping on the user supplied parameter.  
If you closely look at the template, it contains the publicwww query from which we can find more targets. Some queries that I used to find the targets are

      depth:all "country-state-city-auto-dropdown" - **publicwww**
      "/wp-content/plugins/country-state-city-auto-dropdown" - **publicwww**
      http.html:"/wp-content/plugins/country-state-city-auto-dropdown/" - **shodan**
      body="/wp-content/plugins/country-state-city-auto-dropdown/" - **fofa**


These queries will give thousands of urls. You can put those URLs to httpx for technology detection and availabilty.  

https://github.com/user-attachments/assets/73710963-9c74-4b38-b8f5-70ca759e936a

Or you can feed these URLs to nuclei, With -dreq switch of nuclei we'll be able to see the actual HTTP request used to exploit that vulnerability. For this post I'm putting a result of a single website below. (You can give list as arg)

![HTTP request](https://github.com/0xvu1n/0xvu1n.github.io/blob/72b18e51a4c1dd19b11182fc954f8fd20999b274/assets/request.png)

Exploiting further we can manually inject queries or feed this request to sqlmap by putting * at the injection point.
Here the vulnerable parameter is sid.

![sqlmap](https://github.com/0xvu1n/0xvu1n.github.io/blob/8baecaaac74b95f31605dff81764847dc671cb50/assets/sqlmap.png)

Another last alternative to mass scan targets for all known vulnerabilities is to use WPwatcher (Not covering installation here)
WP Watcher is a wrapper for WPScan that manages scans on multiple sites and reports by email and/or syslog. 
Schedule scans and get notified when vulnerabilities, outdated plugins and other risks are found. You can refer the official documentation
[here](https://wpwatcher.readthedocs.io/en/latest/index.html).

**Note: If you run WPscan or WPwatcher against target without the API token then it won't show up the vulnerabilities.
You've to register yourself on https://wpscan.com & grab the API token from profile section which will allow your scan
to perform 23 requests per day. I created three accounts with three different emails to get more number of requests**

This is the simple result for reference

![WPwatcher result](https://github.com/0xvu1n/0xvu1n.github.io/blob/b3c24258ef53dba1cc939538a50489c167fafd90/assets/wpwatch.png)

I hope you found this post useful. Some reference links below

- [Patchstack - About WordPress](https://patchstack.com/academy/wordpress/getting-started/)  
- [WordPress pentesting - ultimate resource guide](https://medium.com/@RaunakGupta1922/mastering-wordpress-pentesting-the-ultimate-resource-guide-423bc1e1ddef)  
- [Pentesting WordPress](https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/wordpress)  
- [WordPress dorks](https://github.com/Proviesec/google-dorks/blob/main/cms/google-dorks-for-wordpress.txt)  
